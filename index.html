<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Noval Book Preview</title>
    
    <!-- Dynamic Open Graph Meta Tags -->
    <meta property="og:title" content="Check out this book on Noval">
    <meta property="og:description" content="Tap to open in the Noval app">
    <meta property="og:image" id="ogImage" content="">
    <meta property="og:url" id="ogUrl" content="">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    
    <!-- Smart App Banner (optional) -->
    <meta name="apple-itunes-app" content="app-id=6742157123">
    
    <script>
        // Extract the book ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const bookId = urlParams.get('id');
        
        // Set Firebase Storage image URL (assuming image is at root with bookId as filename)
        if (bookId) {
            const firebaseImageUrl = `https://firebasestorage.googleapis.com/v0/b/noval-3e2ae.appspot.com/o/${encodeURIComponent(bookId)}?alt=media`;
            
            // Update meta tags for rich preview
            document.getElementById('ogImage').content = firebaseImageUrl;
            document.getElementById('ogUrl').content = window.location.href;
            
            // Try to open app immediately
            window.location.href = `noval://book?id=${bookId}`;
            
            // If app isn't installed, redirect to App Store after delay
            setTimeout(function() {
                window.location.href = "https://apps.apple.com/us/app/echo-in-ear-voice-translator/id6742157123";
            }, 500);
        }
    </script>
    
    <style>
        body {
            font-family: -apple-system, sans-serif;
            text-align: center;
            padding: 2rem;
            color: #333;
        }
        .loading {
            margin-top: 2rem;
        }
    </style>
</head>
<body>
    <h1>Noval</h1>
    <p>Redirecting to the app...</p>
    <div class="loading">
        <svg width="50" height="50" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
            <circle cx="25" cy="25" r="20" stroke="#007AFF" stroke-width="4" fill="none" stroke-dasharray="31.415, 31.415" stroke-dashoffset="0">
                <animateTransform attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="1s" repeatCount="indefinite"/>
            </circle>
        </svg>
    </div>
</body>
</html>
